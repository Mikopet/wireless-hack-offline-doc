<section>
    <h2 class="hide">How to Hack Wi-Fi: Cracking WPA2-PSK Passwords with Cowpatty</h2> 
    <p>Welcome, my hacker novitiates!</p><p>As part of <a href="http://null-byte.wonderhowto.com/how-to/wi-fi-hacking/">my series on hacking Wi-Fi</a>, I want to demonstrate another excellent piece of hacking software for cracking WPA2-PSK passwords. In my last post, we <a href="http://null-byte.wonderhowto.com/how-to/hack-wi-fi-cracking-wpa2-psk-passwords-using-aircrack-ng-0148366/">cracked WPA2 using aircrack-ng</a>. In this tutorial, we'll use a piece of software developed by wireless security researcher Joshua Wright called <strong>cowpatty</strong> (often stylized as coWPAtty). This app simplifies and speeds up the dictionary/hybrid attack against WPA2 passwords, so let's get to it!</p> <figure class="whtGallery" id="39800435docPartGal880041" role="group"><div class="gallery-layout"><div class="gallery-layout-container"><figure class="gal-mgb" data-index="0"><img src="http://img.wonderhowto.com/img/51/22/63513459357162/0/hack-wi-fi-cracking-wpa2-psk-passwords-with-cowpatty.w654.jpg" alt="How to Hack Wi-Fi: Cracking WPA2-PSK Passwords with Cowpatty" width="532" height="532" style="max-width:532px;height:auto;"/></figure></div></div></figure> 
</section>
<section>
    <h2 class="step">Step 1: Find the Cowpatty</h2><p>Cowpatty is one of the hundreds of pieces of software that are included in the <a href="http://null-byte.wonderhowto.com/how-to/hack-like-pro-getting-started-with-backtrack-your-new-hacking-system-0146889/">BackTrack</a> suite of software. For some reason, it was not placed in the <strong>/pentest/wireless</strong> directory, but instead was left in the <strong>/usr/local/bin</strong> directory, so let's navigate there.</p><ul><li><strong>cd /usr/local/bin</strong></li> </ul><p>Because cowpatty is in the <strong>/usr/local/bin</strong> directory and this directory should be in your PATH, we should be able to run it from any directory in BackTrack.</p>
</section>
<section>
    <h2 class="step">Step 2: Find the Cowpatty Help Screen</h2><p>To get a brief rundown of the cowpatty options, simply type:</p><ul><li><strong>cowpatty</strong></li></ul> <figure class="whtGallery" id="49668799docPartGal880029" role="group"><div class="gallery-layout"><div class="gallery-layout-container"><figure class="gal-mgb" data-index="0"><img src="http://img.wonderhowto.com/img/83/19/63513457489542/0/hack-wi-fi-cracking-wpa2-psk-passwords-with-cowpatty.w654.jpg" alt="How to Hack Wi-Fi: Cracking WPA2-PSK Passwords with Cowpatty" width="532" height="532" style="max-width:532px;height:auto;"/></figure></div></div></figure> <p>BackTrack will provide you a brief help screen. Take a note that cowpatty requires all of the following.</p><ul><li><strong>a word list</strong></li> <li><strong>a file where the password hash has been captured</strong></li> <li><strong>the SSID of the target AP</strong></li></ul>
</section>
<section>
    <h2 class="step">Step 3: Place the Wireless Adapter in Monitor Mode</h2><p>Just as in <a href="http://null-byte.wonderhowto.com/how-to/hack-wi-fi-cracking-wpa2-psk-passwords-using-aircrack-ng-0148366/">cracking with aircrack-ng</a>, we need to put the wireless adapter into monitor mode.</p><ul><li><strong>airmon-ng start wlan0</strong></li></ul> <figure class="whtGallery" id="16024736docPartGal880031" role="group"><div class="gallery-layout"><div class="gallery-layout-container"><figure class="gal-mgb" data-index="0"><img src="http://img.wonderhowto.com/img/85/37/63513457501944/0/hack-wi-fi-cracking-wpa2-psk-passwords-with-cowpatty.w654.jpg" alt="How to Hack Wi-Fi: Cracking WPA2-PSK Passwords with Cowpatty" width="532" height="532" style="max-width:532px;height:auto;"/></figure></div></div></figure> 
</section>
<section>
    <h2 class="step">Step 4: Start a Capture File</h2><p>Next, we need to start a capture file where the hashed password will be stored when we capture the 4-way handshake.</p><ul><li><strong>airodump-ng --bssid 00:25:9C:97:4F:48 -c 9 -w cowpatty mon0</strong></li> </ul><p>This will start a dump on the selected AP (<strong>00:25:9C:97:4F:48</strong>), on the selected channel (<strong>-c 9</strong>) and save the the hash in a file named <strong>cowcrack</strong>.</p>
</section>
<section>
    <h2 class="step">Step 5: Capture the Handshake</h2><p>Now when someone connects to the AP, we'll capture the hash and airdump-ng will show us it has been captured in the upper right-hand corner.</p> <figure class="whtGallery" id="35865647docPartGal880033" role="group"><div class="gallery-layout"><div class="gallery-layout-container"><figure class="gal-mgb" data-index="0"><img src="http://img.wonderhowto.com/img/87/73/63513457515360/0/hack-wi-fi-cracking-wpa2-psk-passwords-with-cowpatty.w654.jpg" alt="How to Hack Wi-Fi: Cracking WPA2-PSK Passwords with Cowpatty" width="532" height="532" style="max-width:532px;height:auto;"/></figure></div></div></figure> 
</section>
<section>
    <h2 class="step">Step 6: Run the Cowpatty</h2><p>Now that we have the hash of the password, we can use it with cowpatty and our wordlist to crack the hash.</p><ul><li><strong>cowpatty -f /pentest/passwords/wordlists/darkc0de.lst -r /root/cowcrack-01.cap -s Mandela2</strong></li></ul> <figure class="whtGallery" id="51626076docPartGal880035" role="group"><div class="gallery-layout"><div class="gallery-layout-container"><figure class="gal-mgb" data-index="0"><img src="http://img.wonderhowto.com/img/50/81/63513457532926/0/hack-wi-fi-cracking-wpa2-psk-passwords-with-cowpatty.w654.jpg" alt="How to Hack Wi-Fi: Cracking WPA2-PSK Passwords with Cowpatty" width="532" height="532" style="max-width:532px;height:auto;"/></figure></div></div></figure> <p>As you can see in the screenshot above, cowpatty is generating a hash of every word on our wordlist with the SSID as a seed and comparing it to the captured hash. When the hashes match, it dsplays the password of the AP.</p>
</section>
<section>
    <h2 class="step">Step 7: Make Your Own Hash</h2><p>Although running cowpatty can be rather simple, it can also be very slow. The password hash is hashed with SHA1 with a seed of the SSID. This means that the same password on different SSIDs will generate different hashes. This prevents us from simply using a rainbow table against all APs. Cowpatty must take the password list you provide and compute the hash with the SSID for each word. This is very CPU intensive and slow.</p><p>Cowpatty now supports using a pre-computed hash file rather than a plain-text word file, making the cracking of the WPA2-PSK password 1000x faster! Pre-computed hash files are available from the <strong><a  href="http://www.churchofwifi.org/" rel="nofollow" target="_blank" >Church of WiFi</a></strong>, and these pre-computed hash files are generated using 172,000 dictionary file and the 1,000 most popular SSIDs. As useful as this is, if your SSID is not in that 1,000, the hash list really doesn't help us.</p><p>In that case, we need to generate our own hashes for our target SSID. We can do this by using an application called <strong>genpmk</strong>. We can generate our hash file for the "darkcode" wordlist for the SSID "Mandela2" by typing:</p><ul><li><strong>genpmk -f /pentest/passwords/wordlists/darkc0de.lst -d hashes -s Mandela2</strong></li></ul> <figure class="whtGallery" id="47052592docPartGal880037" role="group"><div class="gallery-layout"><div class="gallery-layout-container"><figure class="gal-mgb" data-index="0"><img src="http://img.wonderhowto.com/img/32/86/63513457544595/0/hack-wi-fi-cracking-wpa2-psk-passwords-with-cowpatty.w654.jpg" alt="How to Hack Wi-Fi: Cracking WPA2-PSK Passwords with Cowpatty" width="532" height="532" style="max-width:532px;height:auto;"/></figure></div></div></figure> 
</section>
<section>
    <h2 class="step">Step 8: Using Our Hash</h2><p>Once we have generated our hashes for the particular SSIDs, we can then crack the password with cowpatty by typing:</p><ul><li><strong>cowpatty -d hashfile -r dumpfile -s ssid</strong></li></ul>
</section>